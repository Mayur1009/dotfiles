#!/usr/bin/env bash

selected=$(fzf --tmux 50% --walker=dir,follow,hidden --walker-root="$HOME" --walker-skip=Library,.Trash,miniforge4,.cache,.git,node_modules,.venv)

if [[ -z $selected ]]; then
	exit 0
fi

sname=$(basename "$selected" | tr . _)

if ! tmux has -t="$sname" 2>/dev/null; then
    tmux new -s "$sname" -n "nvim" -c "$selected" -d \; send-keys -t "$sname:nvim.1" nvim C-m
fi

tmux switch -t "$sname"
